# Disable internal Postgres, use your external DB
postgresql:
  enabled: false

externalDatabase:
  host: postgres-postgresql.data-lake.svc.cluster.local
  port: 5432
  database: prefect
  user: prefectuser
  password: prefectpass

# Storage for Prefect server metadata / logs
persistence:
  enabled: true
  storageClass: microk8s-hostpath
  size: 5Gi

# Prefect Server (UI + API)
server:
  replicaCount: 1
  service:
    type: LoadBalancer
    port: 4200
  ingress:
    enabled: false  # set to true if you want ingress
    annotations: {}
    hosts: []
    tls: []

# Prefect Worker configuration
worker:
  enabled: true
  replicaCount: 2
  config:
    workPool: default-agent-pool
  selfHostedServerApiConfig:
    apiUrl: http://prefect-server.data-lake.svc.cluster.local:4200/api

# Resource requests/limits
resources:
  server:
    requests:
      cpu: "500m"
      memory: "512Mi"
    limits:
      cpu: "1"
      memory: "1Gi"
  worker:
    requests:
      cpu: "200m"
      memory: "256Mi"
    limits:
      cpu: "500m"
      memory: "512Mi"

# Extra volumes if needed for data storage (example: mount /data/warehouse)
extraVolumes:
  - name: warehouse
    persistentVolumeClaim:
      claimName: warehouse-pvc

extraVolumeMounts:
  - name: warehouse
    mountPath: /data/warehouse
